import{g as Ee}from"./assets.627312db.js";import{D as ge}from"./KTDataTable.c389d200.js";import{d as ae,A as _,af as Y,_ as te,r as y,i as C,k as e,q as l,B as j,C as ye,w as t,o as g,I as o,a7 as ke,a6 as Ce,au as De,av as z,x as Ae,aw as L,as as xe,az as we,G as Q,l as v,n as V,F as U,j as Z,m as ee}from"./index.69b36d76.js";import{h as H}from"./dom.77db5301.js";import{v as oe}from"./vue-debounce.min.43c24b86.js";import{c as Fe,a as K,d as le}from"./array.8e0a81f2.js";import{S as Se}from"./sweetalert2.242d9dda.js";const Ve=ae({name:"filter-scan",emits:["filter-data"],setup(a,{emit:u}){var h=0;const A=async()=>{if(p.value.query!=k.value){p.value.query=k.value;return}(h==2||h==1)&&(h--,h==0)||u("filter-data",p.value)},k=_(""),P=oe.exports.debounce(A,1e3),p=_({product_type:"",query:"",vul_type:""});return Y(k,P),Y(p.value,()=>{A()}),{data:p,debouncedSearchTerm:k,submit:A,reset:()=>{h=2,k.value="",p.value.product_type="",p.value.query="",p.value.vul_type=""}}}});const Me={class:"menu menu-sub menu-sub-dropdown w-250px w-md-350px","data-kt-menu":"true"},Pe=e("div",{class:"px-7 py-5"},[e("div",{class:"fs-5 text-dark fw-bold"},"Filter Options")],-1),Be=e("div",{class:"separator border-gray-200"},null,-1),Te={class:"px-7 py-5"},$e={class:"mb-7"},Ie=e("label",{class:"form-label fw-semobold"},"T\xECm ki\u1EBFm:",-1),Ne={class:"d-flex align-items-center position-relative my-1"},Oe={class:"mb-7"},Re=e("label",{class:"form-label fw-semobold"},"T\xECm ki\u1EBFm theo lo\u1EA1i s\u1EA3n ph\u1EA9m:",-1),qe={class:"mb-7"},Ge=e("label",{class:"form-label fw-semobold"},"T\xECm ki\u1EBFm theo lo\u1EA1i l\u1ED7 h\u1ED5ng:",-1),Le=e("div",{class:"separator my-2"},null,-1),Ue={class:"d-flex justify-content-end"},He=e("button",{type:"submit",class:"btn btn-sm btn-primary","data-kt-menu-dismiss":"true"}," Apply ",-1);function Ke(a,u,h,A,k,P){const p=y("KTIcon"),s=y("el-option"),M=y("el-select"),D=y("el-form-item");return g(),C("div",Me,[Pe,Be,e("div",Te,[e("div",$e,[Ie,e("div",Ne,[l(p,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),j(e("input",{type:"text","data-kt-subscription-table-filter":"search","onUpdate:modelValue":u[0]||(u[0]=m=>a.debouncedSearchTerm=m),class:"form-control form-control-solid w-100 ps-14",placeholder:"T\xECm ki\u1EBFm theo m\xE3 CVE"},null,512),[[ye,a.debouncedSearchTerm]])])]),e("div",Oe,[Re,l(D,{prop:"assign"},{default:t(()=>[l(M,{modelValue:a.data.product_type,"onUpdate:modelValue":u[1]||(u[1]=m=>a.data.product_type=m),placeholder:"Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m",name:"product_type",as:"select",height:"40px",class:"input-group-lg"},{default:t(()=>[l(s,{label:"Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m",value:""},{default:t(()=>[o("Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m")]),_:1}),l(s,{label:"Microsoft",value:"0"},{default:t(()=>[o("Microsoft")]),_:1}),l(s,{label:"Oracle",value:"1"},{default:t(()=>[o("Oracle")]),_:1}),l(s,{label:"Google",value:"2"},{default:t(()=>[o("Google")]),_:1}),l(s,{label:"Debian",value:"3"},{default:t(()=>[o("Debian")]),_:1}),l(s,{label:"Apple",value:"4"},{default:t(()=>[o("Apple")]),_:1}),l(s,{label:"IBM",value:"5"},{default:t(()=>[o("IBM")]),_:1}),l(s,{label:"Redhat",value:"6"},{default:t(()=>[o("Redhat")]),_:1}),l(s,{label:"Fedoraproject",value:"7"},{default:t(()=>[o("Fedoraproject")]),_:1}),l(s,{label:"Canonical",value:"8"},{default:t(()=>[o("Canonical")]),_:1}),l(s,{label:"Cisco",value:"9"},{default:t(()=>[o("Cisco")]),_:1}),l(s,{label:"Linux",value:"10"},{default:t(()=>[o("Linux")]),_:1}),l(s,{label:"Opensuse",value:"11"},{default:t(()=>[o("Opensuse")]),_:1}),l(s,{label:"Mozilla",value:"12"},{default:t(()=>[o("Mozilla")]),_:1}),l(s,{label:"Netapp",value:"13"},{default:t(()=>[o("Netapp")]),_:1}),l(s,{label:"Apache",value:"14"},{default:t(()=>[o("Apache")]),_:1}),l(s,{label:"HP",value:"15"},{default:t(()=>[o("HP")]),_:1}),l(s,{label:"Adobe",value:"16"},{default:t(()=>[o("Adobe")]),_:1}),l(s,{label:"SUN",value:"17"},{default:t(()=>[o("SUN")]),_:1}),l(s,{label:"Jenkins",value:"18"},{default:t(()=>[o("Jenkins")]),_:1}),l(s,{label:"SAP",value:"19"},{default:t(()=>[o("SAP")]),_:1}),l(s,{label:"Suse",value:"20"},{default:t(()=>[o("Suse")]),_:1}),l(s,{label:"Siemens",value:"21"},{default:t(()=>[o("Siemens")]),_:1}),l(s,{label:"GNU",value:"22"},{default:t(()=>[o("GNU")]),_:1}),l(s,{label:"Gitlab",value:"23"},{default:t(()=>[o("Gitlab")]),_:1}),l(s,{label:"Huawei",value:"24"},{default:t(()=>[o("Huawei")]),_:1}),l(s,{label:"F5",value:"25"},{default:t(()=>[o("F5")]),_:1}),l(s,{label:"PHP",value:"26"},{default:t(()=>[o("PHP")]),_:1}),l(s,{label:"Intel",value:"27"},{default:t(()=>[o("Intel")]),_:1}),l(s,{label:"Vmware",value:"28"},{default:t(()=>[o("Vmware")]),_:1}),l(s,{label:"Imagemagick",value:"29"},{default:t(()=>[o("Imagemagick")]),_:1}),l(s,{label:"Wireshark",value:"30"},{default:t(()=>[o("Wireshark")]),_:1}),l(s,{label:"Novell",value:"31"},{default:t(()=>[o("Novell")]),_:1}),l(s,{label:"Dell",value:"32"},{default:t(()=>[o("Dell")]),_:1}),l(s,{label:"Mcafee",value:"33"},{default:t(()=>[o("Mcafee")]),_:1}),l(s,{label:"Symantec",value:"34"},{default:t(()=>[o("Symantec")]),_:1}),l(s,{label:"Fortinet",value:"35"},{default:t(()=>[o("Fortinet")]),_:1}),l(s,{label:"Moodle",value:"36"},{default:t(()=>[o("Moodle")]),_:1}),l(s,{label:"Juniper",value:"37"},{default:t(()=>[o("Juniper")]),_:1}),l(s,{label:"Freebsd",value:"38"},{default:t(()=>[o("Freebsd")]),_:1}),l(s,{label:"Joomla",value:"39"},{default:t(()=>[o("Joomla")]),_:1}),l(s,{label:"XEN",value:"40"},{default:t(()=>[o("XEN")]),_:1}),l(s,{label:"Broadcom",value:"41"},{default:t(()=>[o("Broadcom")]),_:1}),l(s,{label:"Cpanel",value:"42"},{default:t(()=>[o("Cpanel")]),_:1}),l(s,{label:"Zohocorp",value:"43"},{default:t(()=>[o("Zohocorp")]),_:1}),l(s,{label:"Ffmpeg",value:"44"},{default:t(()=>[o("Ffmpeg")]),_:1}),l(s,{label:"Atlassian",value:"45"},{default:t(()=>[o("Atlassian")]),_:1}),l(s,{label:"Mariadb",value:"46"},{default:t(()=>[o("Mariadb")]),_:1}),l(s,{label:"EMC",value:"47"},{default:t(()=>[o("EMC")]),_:1}),l(s,{label:"Wordpress",value:"48"},{default:t(()=>[o("Wordpress")]),_:1}),l(s,{label:"Qemu",value:"49"},{default:t(()=>[o("Qemu")]),_:1}),l(s,{label:"Kh\xE1c",value:"50"},{default:t(()=>[o("Kh\xE1c")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),e("div",qe,[Ge,l(D,{prop:"assign"},{default:t(()=>[l(M,{modelValue:a.data.vul_type,"onUpdate:modelValue":u[2]||(u[2]=m=>a.data.vul_type=m),placeholder:"Ch\u1ECDn lo\u1EA1i l\u1ED7 h\u1ED5ng",name:"vul_type",as:"select"},{default:t(()=>[l(s,{label:"Ch\u1ECDn lo\u1EA1i l\u1ED7 h\u1ED5ng",value:""},{default:t(()=>[o("Ch\u1ECDn lo\u1EA1i l\u1ED7 h\u1ED5ng")]),_:1}),l(s,{label:"DoS",value:"0"},{default:t(()=>[o("DoS")]),_:1}),l(s,{label:"Code Execution",value:"1"},{default:t(()=>[o("Code Execution")]),_:1}),l(s,{label:"Overflow",value:"2"},{default:t(()=>[o("Overflow")]),_:1}),l(s,{label:"Memory Corruption",value:"3"},{default:t(()=>[o("Memory Corruption")]),_:1}),l(s,{label:"Sql Injection",value:"4"},{default:t(()=>[o("Sql Injection")]),_:1}),l(s,{label:"XSS",value:"5"},{default:t(()=>[o("XSS")]),_:1}),l(s,{label:"Directory Traversal",value:"6"},{default:t(()=>[o("Directory Traversal")]),_:1}),l(s,{label:"Http Response Splitting",value:"7"},{default:t(()=>[o("Http Response Splitting ")]),_:1}),l(s,{label:"Bypass something",value:"8"},{default:t(()=>[o("Bypass something")]),_:1}),l(s,{label:"Gain Information",value:"9"},{default:t(()=>[o("Gain Information")]),_:1}),l(s,{label:"Gain Privileges",value:"10"},{default:t(()=>[o("Gain Privileges")]),_:1}),l(s,{label:"CSRF",value:"11"},{default:t(()=>[o("CSRF")]),_:1}),l(s,{label:"File Inclusion",value:"12"},{default:t(()=>[o("File Inclusion")]),_:1}),l(s,{label:"Kh\xE1c",value:"13"},{default:t(()=>[o("Kh\xE1c")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),Le,e("div",Ue,[e("button",{onClick:u[3]||(u[3]=(...m)=>a.reset&&a.reset(...m)),type:"reset",class:"btn btn-sm btn-outline btn-outline-dashed btn-outline-info me-2"}," Reset "),He])])])}const je=te(Ve,[["render",Ke]]),We=ae({name:"kt-target-list",components:{KTDatatable:ge,ErrorMessage:ke,Field:Ce,VForm:De,Fillter:je},directives:{debounce:oe.exports.vue3Debounce({lock:!0})},setup(){const a=_([]),u=_(0),h=_(1),A=_(20),k=_(""),P=_(""),p=_(""),s=_(""),M=_(""),D=_(0),m=_(""),r=_({code:"",product_type:"",product_text:"",vul_type:"",vul_text:"",description:"",version:"",shodan_dock:"",poc:""}),i=z({code:"",product_type:"",vul_type:"",description:"",version:"",shodan_dock:"",poc:"",detail:""}),b=z({id:"",code:"",product_text:"",product_type:"",vul_text:"",vul_type:"",description:"",version:"",shodan_dock:"",poc:"",modified_at:"",created_at:""}),T=_(null),$=_(null),B=_(!1),N=[{value:0,label:"DoS"},{value:1,label:"Code Execution"},{value:2,label:"Overflow"},{value:3,label:"Memory Corruption"},{value:4,label:"Code Execution"},{value:5,label:"XSS"},{value:6,label:"Directory Traversal"},{value:7,label:"Http Response Splitting"},{value:8,label:"Bypass something"},{value:9,label:"Gain Information"},{value:10,label:"Gain Privileges"},{value:11,label:"CSRF"},{value:12,label:"File Inclusion"},{value:13,label:"Kh\xE1c"}],O=[{value:0,label:"Microsoft"},{value:1,label:"Oracle"},{value:2,label:"Google"},{value:3,label:"Debian"},{value:4,label:"Apple"},{value:5,label:"IBM"},{value:6,label:"Redhat"},{value:7,label:"Fedoraproject"},{value:8,label:"Canonical"},{value:9,label:"Cisco"},{value:10,label:"Linux"},{value:11,label:"Opensuse"},{value:12,label:"Mozilla"},{value:13,label:"Netapp"},{value:14,label:"Apache"},{value:15,label:"HP"},{value:16,label:"Adobe"},{value:17,label:"SUN"},{value:18,label:"Jenkins"},{value:19,label:"SAP"},{value:20,label:"Suse"},{value:21,label:"Siemens"},{value:22,label:"GNU"},{value:23,label:"Gitlab"},{value:24,label:"Huawei"},{value:25,label:"F5"},{value:26,label:"PHP"},{value:27,label:"Intel"},{value:28,label:"Vmware"},{value:29,label:"Imagemagick"},{value:30,label:"Wireshark"},{value:31,label:"Novell"},{value:32,label:"Dell"},{value:33,label:"Mcafee"},{value:34,label:"Symantec"},{value:35,label:"Fortinet"},{value:36,label:"Moodle"},{value:37,label:"Juniper"},{value:38,label:"Freebsd"},{value:39,label:"Joomla"},{value:40,label:"XEN"},{value:41,label:"Broadcom"},{value:42,label:"Cpanel"},{value:43,label:"Zohocorp"},{value:44,label:"Ffmpeg"},{value:45,label:"Atlassian"},{value:46,label:"Mariadb"},{value:47,label:"EMC"},{value:48,label:"Wordpress"},{value:49,label:"Qemu"},{value:50,label:"Kh\xE1c"}],R=_([{columnName:"ID",columnLabel:"id",sortEnabled:!0},{columnName:"M\xE3 CVE",columnLabel:"code",columnWidth:150},{columnName:"Lo\u1EA1i s\u1EA3n ph\u1EA9m",columnLabel:"product_text",columnWidth:150},{columnName:"Lo\u1EA1i l\u1ED7 h\u1ED5ng",columnLabel:"vul_text",columnWidth:150},{columnName:"M\xF4 t\u1EA3",columnLabel:"description",columnWidth:220},{columnName:"H\xE0nh \u0111\u1ED9ng",columnLabel:"actions",columnWidth:50}]),q=(n,f)=>{M.value=f,i.code="",i.product_type="",i.vul_type="",i.description="",i.version="",i.shodan_dock="",i.poc="",i.detail="",Object.keys(n).length!=0&&f==="edit"?(m.value="Ch\u1EC9nh s\u1EEDa CVE",r.value.code=n.code,r.value.product_type=n.product_type,r.value.vul_type=n.vul_type,r.value.description=n.description,r.value.version=n.version,r.value.shodan_dock=n.shodan_dock,r.value.poc=n.poc,D.value=n.id):(m.value="Th\xEAm m\u1EDBi CVE",r.value.vul_type="",r.value.product_type="",T.value!==null&&T.value.click())},d=n=>{h.value=n!=null?n:1,x()},I=(n,f)=>n.length>f?n.substring(0,f)+"...":n,se=n=>{h.value=1,A.value=n!=null?n:20,x()},x=()=>(B.value=!0,setTimeout(()=>B.value=!1,500),L.get(`cve/index?code=${k.value}&product_type=${P.value}&vul_type=${p.value}&page=${h.value}&page_size=${A.value}&ordering=${s.value}`).then(({data:n})=>{a.value=n.results,u.value=n.count}).catch(({response:n})=>{w(n.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})),G=_([]),ne=()=>{J(G.value)},de=()=>{console.log(r.value.product_type!="",r.value.product_type,123123),r.value.product_type!==""&&(i.product_type=""),r.value.vul_type!==""&&(i.vul_type="")},ue=()=>{i.code=""},W=_(null),J=n=>{let f={id:n};if(n)return L.post("cve/delete",f).then(({data:F})=>{w(F.detail,"success","X\xF3a th\xE0nh c\xF4ng"),h.value=1,G.value.length=0,x()}).catch(({response:F})=>{w(F.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})},ie=n=>{n.label&&(s.value=n.order==="asc"?`${n.label}`:`-${n.label}`),x()},ce=n=>{n?(b.id=n.id,b.code=n.code,b.product_text=n.product_text,b.product_type=n.product_type,b.vul_text=n.vul_text,b.vul_type=n.vul_type,b.description=n.description,b.version=n.version,b.shodan_dock=n.shodan_dock,b.poc=n.poc,b.modified_at=n.modified_at,b.created_at=n.created_at,new xe(document.getElementById("kt_modal_detail")).show()):w("","error","C\xF3 l\u1ED7i x\u1EA3y ra")},re=n=>{G.value=n},E=_(null),ve=_(null),X=_(null),_e=/^[Cc][Vv][Ee]-\d{4}-\d+$/,pe=Fe().shape({code:K().matches(_e,"M\xE3 CVE kh\xF4ng \u0111\xFAng \u0111\u1ECBnh d\u1EA1ng").required("Vui l\xF2ng nh\u1EADp m\xE3 CVE"),product_type:le(),vul_type:le(),version:K().required("M\u1EE5c phi\xEAn b\u1EA3n \u1EA3nh h\u01B0\u1EDFng kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng"),shodan_dock:K().required("M\u1EE5c Shodan Dock kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC3 tr\u1ED1ng")}),w=(n,f,F)=>{Se.fire({text:n!=null?n:F,icon:f,buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{H(X.value),H(W.value),H($.value)})},me=async()=>{var f,F;if(!E.value)return;let n={code:r.value.code,product_type:(f=r.value.product_type)!=null?f:"",vul_type:(F=r.value.vul_type)!=null?F:"",description:r.value.description,version:r.value.version,shodan_dock:r.value.shodan_dock,poc:r.value.poc};return M.value=="add"?L.post("cve/create/",n).then(({data:c})=>{E.value&&(E.value.disabled=!0,E.value.setAttribute("data-kt-indicator","on"),setTimeout(()=>{var S;E.value&&(E.value.disabled=!1,(S=E.value)==null||S.removeAttribute("data-kt-indicator")),w(c.detail,"success","Th\xEAm m\u1EDBi th\xE0nh c\xF4ng"),x()},1e3))}).catch(({response:c})=>{var S;c!=null&&c.data?(i.code=c.data.code,i.product_type=c.data.product_type,i.vul_type=c.data.vul_type,i.description=c.data.description,i.version=c.data.version,i.shodan_dock=c.data.shodan_dock,i.poc=c.data.poc,i.detail=c.data.detail):w((S=c==null?void 0:c.data)==null?void 0:S.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")}):L.put(`/cve/${D.value}/update/`,n).then(({data:c})=>{E.value&&(E.value.disabled=!0,E.value.setAttribute("data-kt-indicator","on"),setTimeout(()=>{var S;E.value&&(E.value.disabled=!1,(S=E.value)==null||S.removeAttribute("data-kt-indicator")),w(c.detail,"success","S\u1EEDa m\u1EDBi th\xE0nh c\xF4ng"),x()},1e3))}).catch(({response:c})=>{c.data?(i.code=c.data.code,i.product_type=c.data.product_type,i.vul_type=c.data.vul_type,i.description=c.data.description,i.version=c.data.version,i.shodan_dock=c.data.shodan_dock,i.poc=c.data.poc,i.detail=c.data.detail,console.log(i)):w(c.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})},be=n=>{if(n==="false"||n==="null")return"--:--";const f="DD/MM/YYYY HH:mm:ss";return we(n).format(f)},he=n=>{k.value=n.target.value,h.value=1},fe=n=>{n?(k.value=n.query,P.value=n.product_type,p.value=n.vul_type,h.value=1,x()):w("C\xF3 l\u1ED7i v\u1EDBi filter","error","C\xF3 l\u1ED7i x\u1EA3y ra")};return Ae(()=>{x()}),{getData:x,list:a,headerConfig:R,sort:ie,onItemSelect:re,selectedIds:G,deleteFewSubscriptions:ne,deleteSubscription:J,getAssetPath:Ee,truncateText:I,apiData:r,validationSchema:pe,submit:me,submitButtonRef:E,modalRef:ve,newTargetGroupModalRef:X,handleClick:q,errors:i,ModalDelete:W,discardButtonRef:T,ModalDetail:$,customRowTable:ce,detailData:b,itemsPerPage:A,totalPage:u,currentPage:h,handlePage:d,handlePerPage:se,query:k,setQuery:he,handleFilter:fe,nameType:m,formatDate:be,loading:B,dataVul:N,dataProduct:O,removeErrorMsgOption:de,removeErrorMsgText:ue}}}),Je={class:"card h-100 d-block"},Xe={class:"card-header border-0 pt-6 position-absolute end-0 pe-1",style:{top:"-80px"}},Ye={class:"card-toolbar"},ze={class:"d-flex justify-content-end","data-kt-subscription-table-toolbar":"base"},Qe={type:"button",class:"btn btn-sm fw-bold bg-body btn-color-gray-700 btn-active-color-primary me-2","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end","data-kt-menu-flip":"top-end"},Ze={class:"d-flex justify-content-end align-items-center"},el={class:"fw-bold me-5"},ll={class:"me-2"},al=e("button",{type:"button","data-bs-target":"#kt_modal_delete","data-bs-toggle":"modal",class:"btn btn-danger btn-sm"}," Delete Selected ",-1),tl={class:"card-body pt-0 overflow-scroll h-100 p-0 m-0"},ol=["onClick"],sl={class:"modal fade",tabindex:"-1",id:"kt_modal_new_target_group",ref:"newTargetGroupModalRef","aria-hidden":"true"},nl={class:"modal-dialog modal-dialog-centered mw-900px"},dl={class:"modal-content"},ul={class:"modal-header",id:"kt_modal_new_target_group_header"},il={class:"btn btn-sm btn-icon btn-active-color-primary","data-bs-dismiss":"modal"},cl={class:"modal-body py-10 px-lg-17"},rl={class:"scroll-y me-n7 pe-7",id:"kt_modal_new_target_group_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_new_target_group_header","data-kt-scroll-wrappers":"#kt_modal_new_target_group_scroll","data-kt-scroll-offset":"300px"},vl={class:"mb-5 fv-row row"},_l={class:"col-4"},pl=e("label",{class:"d-flex align-items-center fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"M\xE3 CVE")],-1),ml={class:"fv-plugins-message-container"},bl={class:"fv-help-block"},hl={key:0,class:""},fl={class:"col-4"},El=e("label",{class:"d-flex align-items-center fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Lo\u1EA1i s\u1EA3n ph\u1EA9m")],-1),gl={class:"fv-plugins-message-container"},yl={class:"fv-help-block"},kl={key:0,class:""},Cl={class:"col-4"},Dl=e("label",{class:"d-flex align-items-center fs-6 fw-semobold mb-2"},[e("span",{class:"required"},"Lo\u1EA1i s\u1EA3n ph\u1EA9m")],-1),Al={class:"fv-plugins-message-container"},xl={class:"fv-help-block"},wl={key:0,class:""},Fl={class:"d-flex flex-column mb-5 fv-row"},Sl=e("label",{class:"fs-6 fw-semobold mb-2"},"M\xF4 t\u1EA3",-1),Vl={class:"fv-plugins-message-container"},Ml={class:"fv-help-block"},Pl={class:"d-flex flex-column mb-5 fv-row"},Bl=e("label",{class:"fs-6 fw-semobold mb-2 required"},"Phi\xEAn b\u1EA3n \u1EA3nh h\u01B0\u1EDFng",-1),Tl={class:"fv-plugins-message-container"},$l={class:"fv-help-block"},Il={key:0,class:""},Nl={class:"d-flex flex-column mb-5 fv-row"},Ol=e("label",{class:"fs-6 fw-semobold mb-2 required"},"Shodan Dock",-1),Rl={class:"fv-plugins-message-container"},ql={class:"fv-help-block"},Gl={key:0,class:""},Ll={class:"d-flex flex-column mb-5 fv-row"},Ul=e("label",{class:"fs-6 fw-semobold mb-2"},"POC",-1),Hl={class:"fv-plugins-message-container"},Kl={class:"fv-help-block"},jl={key:0,class:""},Wl={class:"fv-plugins-message-container"},Jl={class:"fv-help-block"},Xl={key:0,class:""},Yl={class:"modal-footer flex-center"},zl={ref:"discardButtonRef",type:"reset",id:"kt_modal_new_target_group_cancel",class:"btn btn-sm btn-light me-3"},Ql={ref:"submitButtonRef",type:"submit",id:"kt_modal_new_target_group_submit",class:"btn btn-sm btn-primary"},Zl=e("span",{class:"indicator-label"}," Submit ",-1),ea=e("span",{class:"indicator-progress"},[o(" Please wait... "),e("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),la=[Zl,ea],aa={class:"modal fade",tabindex:"-1",id:"kt_modal_delete",ref:"ModalDelete","aria-hidden":"true"},ta={class:"modal-dialog modal-dialog-centered"},oa={class:"modal-content"},sa=e("div",{class:"modal-header"},[e("h3",{class:"modal-title"},"X\xE1c nh\u1EADn x\xF3a CVE"),e("div",{class:"btn btn-icon btn-sm btn-active-light-primary ms-2","data-bs-dismiss":"modal","aria-label":"Close"},[e("span",{class:"svg-icon svg-icon-2x"})])],-1),na={class:"modal-body"},da={style:{"font-size":"16px"}},ua={key:0,class:"fw-bold",style:{color:"red"}},ia={class:"modal-footer"},ca=e("button",{type:"button",class:"btn btn-sm btn-light","data-bs-dismiss":"modal"}," H\u1EE7y b\u1ECF ",-1),ra={class:"modal fade",tabindex:"-1",ref:"ModalDetail","aria-hidden":"true",id:"kt_modal_detail"},va={class:"modal-dialog modal-dialog-centered mw-650px"},_a={class:"modal-content"},pa={class:"modal-body"},ma={class:"card card-flush pt-3 mb-5 mb-xl-10"},ba={class:"card-header"},ha={class:"card-title"},fa={class:"fw-bold"},Ea={class:"card-toolbar"},ga={class:"card-body py-0"},ya={class:"mb-10"},ka=e("h6",null,"Th\xF4ng tin chi ti\u1EBFt:",-1),Ca={class:"py-5"},Da={class:"me-5"},Aa={class:"row fs-6 mb-3"},xa=e("div",{class:"col-3 text-gray-400"},"Lo\u1EA1i s\u1EA3n ph\u1EA9m:",-1),wa={class:"col-9 text-gray-800 fs-5 fw-bold"},Fa={class:"row fs-6 mb-3"},Sa=e("div",{class:"col-3 text-gray-400"},"Lo\u1EA1i l\u1ED7 h\u1ED5ng:",-1),Va={class:"col-9 text-gray-800"},Ma={class:"row fs-6 mb-3"},Pa=e("div",{class:"col-3 text-gray-400"},"M\xF4 t\u1EA3:",-1),Ba={class:"col-9 text-gray-800"},Ta={class:"row fs-6 mb-3"},$a=e("div",{class:"col-3 text-gray-400"},"Phi\xEAn b\u1EA3n:",-1),Ia={class:"col-9 text-gray-800"},Na={class:"row fs-6 mb-3"},Oa=e("div",{class:"col-3 text-gray-400"},"Shodan dock:",-1),Ra={class:"col-9 text-gray-800"},qa={class:"row fs-6 mb-3"},Ga=e("div",{class:"col-3 text-gray-400"},"POC:",-1),La={class:"col-9 text-gray-800"},Ua={class:"row fs-6 mb-3"},Ha=e("div",{class:"col-3 text-gray-400"},"Ng\xE0y t\u1EA1o:",-1),Ka={class:"col-9 text-gray-800"},ja={class:"row fs-6"},Wa=e("div",{class:"col-3 text-gray-400"},"Ng\xE0y c\u1EADp nh\u1EADp:",-1),Ja={class:"col-9 text-gray-800"},Xa=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-sm btn-primary me-9","data-bs-dismiss":"modal"}," Quay l\u1EA1i ")],-1);function Ya(a,u,h,A,k,P){var $,B,N,O,R,q;const p=y("KTIcon"),s=y("Fillter"),M=y("KTDatatable"),D=y("Field"),m=y("ErrorMessage"),r=y("el-option"),i=y("el-select"),b=y("el-form-item"),T=y("VForm");return g(),C(U,null,[e("div",Je,[e("div",Xe,[e("div",Ye,[j(e("div",null,[e("div",ze,[e("button",Qe,[l(p,{"icon-name":"filter","icon-class":"fs-2"}),o(" Filter ")]),l(s,{onFilterData:a.handleFilter},null,8,["onFilterData"]),e("button",{type:"button",class:"btn btn-sm fw-bold btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClickPassive:u[0]||(u[0]=d=>a.handleClick({},"add"))},[l(p,{"icon-name":"plus","icon-class":"fs-2"}),o(" Th\xEAm ")],32)])],512),[[Q,a.selectedIds.length===0]]),j(e("div",null,[e("div",Ze,[e("div",el,[e("span",ll,v(a.selectedIds.length),1),o("Selected ")]),al])],512),[[Q,a.selectedIds.length!==0]])])]),e("div",tl,[l(M,{onOnSort:a.sort,onOnItemsSelect:a.onItemSelect,data:a.list,header:a.headerConfig,loading:a.loading,"checkbox-enabled":!0,itemsPerPage:a.itemsPerPage,total:a.totalPage,currentPage:a.currentPage,onPageChange:a.handlePage,onOnItemsPerPageChange:a.handlePerPage,onCustomRow:a.customRowTable},{id:t(({row:d})=>[o(v(d.id),1)]),code:t(({row:d})=>[o(v(d.code),1)]),product_text:t(({row:d})=>[o(v(d.product_text),1)]),vul_text:t(({row:d})=>[o(v(d.vul_text),1)]),description:t(({row:d})=>{var I;return[o(v(a.truncateText((I=d.description)!=null?I:"",25)),1)]}),actions:t(({row:d})=>[e("button",{type:"button",class:"btn btn-icon btn-bg-light btn-active-color-warning btn-sm me-1","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClick:I=>a.handleClick(d,"edit")},[l(p,{"icon-name":"pencil","icon-class":"fs-3"})],8,ol)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading","itemsPerPage","total","currentPage","onPageChange","onOnItemsPerPageChange","onCustomRow"])])]),e("div",sl,[e("div",nl,[e("div",dl,[e("div",ul,[e("h2",null,v(a.nameType),1),e("div",il,[l(p,{"icon-name":"cross","icon-class":"fs-1"})])]),l(T,{id:"kt_modal_new_target_group_form",class:"form",onSubmit:a.submit,"validation-schema":a.validationSchema},{default:t(()=>[e("div",cl,[e("div",rl,[e("div",vl,[e("div",_l,[pl,l(D,{type:"text",class:"form-control form-control-solid",placeholder:"CVE-YYYY-xxxxxx",onKeydown:a.removeErrorMsgText,name:"code",modelValue:a.apiData.code,"onUpdate:modelValue":u[1]||(u[1]=d=>a.apiData.code=d)},null,8,["onKeydown","modelValue"]),e("div",ml,[e("div",bl,[l(m,{name:"code"}),a.errors.code?(g(),C("span",hl,v(a.errors.code[0]),1)):V("",!0)])])]),e("div",fl,[El,l(b,{prop:"assign"},{default:t(()=>[l(i,{placeholder:"Ch\u1ECDn ki\u1EC3u",as:"select",height:"40px",name:"product_text",onChange:a.removeErrorMsgOption,class:"input-group-lg",modelValue:a.apiData.product_type,"onUpdate:modelValue":u[2]||(u[2]=d=>a.apiData.product_type=d),modelModifiers:{lazy:!0}},{default:t(()=>[l(r,{label:"Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m",value:""},{default:t(()=>[o("Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m")]),_:1}),(g(!0),C(U,null,Z(a.dataProduct,d=>(g(),ee(r,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"]),e("div",gl,[e("div",yl,[l(m,{name:"product_type"}),a.errors.product_type?(g(),C("span",kl,v(a.errors.product_type[0]),1)):V("",!0)])])]),_:1})]),e("div",Cl,[Dl,l(b,{prop:"assign"},{default:t(()=>[l(i,{placeholder:"Ch\u1ECDn ki\u1EC3u",as:"select",height:"40px",onChange:a.removeErrorMsgOption,class:"input-group-lg",modelValue:a.apiData.vul_type,"onUpdate:modelValue":u[3]||(u[3]=d=>a.apiData.vul_type=d)},{default:t(()=>[l(r,{label:"Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m",value:""},{default:t(()=>[o("Ch\u1ECDn lo\u1EA1i s\u1EA3n ph\u1EA9m")]),_:1}),(g(!0),C(U,null,Z(a.dataVul,d=>(g(),ee(r,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"]),e("div",Al,[e("div",xl,[l(m,{name:"vul_type"}),a.errors.vul_type?(g(),C("span",wl,v(a.errors.vul_type[0]),1)):V("",!0)])])]),_:1})])]),e("div",Fl,[Sl,l(D,{as:"textarea",class:"form-control form-control-solid",rows:"5",name:"description",placeholder:"M\xF4 t\u1EA3 v\u1EC1 CVE",modelValue:a.apiData.description,"onUpdate:modelValue":u[4]||(u[4]=d=>a.apiData.description=d)},null,8,["modelValue"]),e("div",Vl,[e("div",Ml,[l(m,{name:"description"})])])]),e("div",Pl,[Bl,l(D,{as:"textarea",class:"form-control form-control-solid",rows:"5",name:"version",placeholder:"Phi\xEAn b\u1EA3n s\u1EA3n ph\u1EA9m b\u1ECB \u1EA3nh h\u01B0\u1EDFng b\u1EDFi CVE",modelValue:a.apiData.version,"onUpdate:modelValue":u[5]||(u[5]=d=>a.apiData.version=d)},null,8,["modelValue"]),e("div",Tl,[e("div",$l,[l(m,{name:"version"}),a.errors.version?(g(),C("span",Il,v(a.errors.version[0]),1)):V("",!0)])])]),e("div",Nl,[Ol,l(D,{as:"textarea",class:"form-control form-control-solid",rows:"5",name:"shodan_dock",placeholder:"C\xE2u query shodan \u0111\u1EC3 t\xECm ki\u1EBFm m\u1EE5c ti\xEAu tr\xEAn di\u1EC7n r\u1ED9ng. C\xFA ph\xE1p theo c\xFA ph\xE1p t\xECm ki\u1EBFm c\u1EE7a shodan. Query ph\xE2n c\xE1ch b\u1EDFi d\u1EA5u ;",modelValue:a.apiData.shodan_dock,"onUpdate:modelValue":u[6]||(u[6]=d=>a.apiData.shodan_dock=d)},null,8,["modelValue"]),e("div",Rl,[e("div",ql,[l(m,{name:"shodan_dock"}),a.errors.shodan_dock?(g(),C("span",Gl,v(a.errors.shodan_dock[0]),1)):V("",!0)])])]),e("div",Ll,[Ul,l(D,{as:"textarea",class:"form-control form-control-solid",rows:"5",name:"poc",placeholder:"Th\xF4ng tin POC, c\xE1ch khai th\xE1c",modelValue:a.apiData.poc,"onUpdate:modelValue":u[7]||(u[7]=d=>a.apiData.poc=d)},null,8,["modelValue"]),e("div",Hl,[e("div",Kl,[l(m,{name:"poc"}),a.errors.poc?(g(),C("span",jl,v(a.errors.poc[0]),1)):V("",!0)])])]),e("div",Wl,[e("div",Jl,[a.errors.detail?(g(),C("span",Xl,v(Array.isArray(a.errors.detail)?a.errors.detail[0]:a.errors.detail),1)):V("",!0)])])])]),e("div",Yl,[e("button",zl," Discard ",512),e("button",Ql,la,512)])]),_:1},8,["onSubmit","validation-schema"])])])],512),e("div",aa,[e("div",ta,[e("div",oa,[sa,e("div",na,[e("p",da,[o("B\u1EA1n c\xF3 ch\u1EAFc ch\u1EAFn mu\u1ED1n x\xF3a "),a.selectedIds.length>0?(g(),C("span",ua,v(a.selectedIds.length),1)):V("",!0),o(" b\u1EA3n ghi n\xE0y kh\xF4ng? ")])]),e("div",ia,[ca,e("button",{type:"button",class:"btn btn-sm btn-primary",onClickPassive:u[8]||(u[8]=d=>a.deleteFewSubscriptions())}," \u0110\u1ED3ng \xFD ",32)])])])],512),e("div",ra,[e("div",va,[e("div",_a,[e("div",pa,[e("div",ma,[e("div",ba,[e("div",ha,[e("h1",fa,v(a.detailData.code),1)]),e("div",Ea,[e("button",{type:"button",class:"btn btn-light-warning btn-sm me-1","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClick:u[9]||(u[9]=d=>a.handleClick(a.detailData,"edit"))},[l(p,{"icon-name":"pencil","icon-class":"fs-3"}),o(" Update ")])])]),e("div",ga,[e("div",ya,[ka,e("div",Ca,[e("div",Da,[e("div",null,[e("div",Aa,[xa,e("div",wa,[e("span",null,v(($=a.detailData.product_text)!=null?$:"--"),1)])]),e("div",Fa,[Sa,e("div",Va,[e("span",null,v((B=a.detailData.vul_text)!=null?B:"--"),1)])]),e("div",Ma,[Pa,e("div",Ba,[e("span",null,v((N=a.detailData.description)!=null?N:"--"),1)])]),e("div",Ta,[$a,e("div",Ia,[e("span",null,v((O=a.detailData.version)!=null?O:"--"),1)])]),e("div",Na,[Oa,e("div",Ra,[e("span",null,v((R=a.detailData.shodan_dock)!=null?R:"--"),1)])]),e("div",qa,[Ga,e("div",La,[e("span",null,v((q=a.detailData.poc)!=null?q:"--"),1)])]),e("div",Ua,[Ha,e("div",Ka,[e("span",null,v(a.formatDate(a.detailData.created_at)),1)])]),e("div",ja,[Wa,e("div",Ja,[e("span",null,v(a.formatDate(a.detailData.modified_at)),1)])])])])])])])])]),Xa])])],512)],64)}const ot=te(We,[["render",Ya]]);export{ot as default};
