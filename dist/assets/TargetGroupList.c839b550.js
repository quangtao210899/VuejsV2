import{g as dt}from"./assets.627312db.js";import{D as rt}from"./KTDataTable.c389d200.js";import{d as j,A as l,af as O,_ as W,r as k,i as P,k as t,q as u,B as M,C as ct,o as C,a7 as ut,a6 as mt,au as _t,av as L,x as bt,aw as S,as as ht,G as K,I as E,l as r,w,n as U,m as G,F as gt}from"./index.69b36d76.js";import{h as V}from"./dom.77db5301.js";import{v as z}from"./vue-debounce.min.43c24b86.js";import{c as pt,a as vt}from"./array.8e0a81f2.js";import{S as ft}from"./sweetalert2.242d9dda.js";const Et=j({name:"filter-scan",components:{},emits:["filter-data"],setup(e,{emit:o}){var d=0;const h=async()=>{if(i.value.query!=m.value){i.value.query=m.value;return}(d==2||d==1)&&(d--,d==0)||o("filter-data",i.value)},m=l(""),F=z.exports.debounce(h,1e3),i=l({query:""});return O(m,F),O(i.value,()=>{h()}),{data:i,debouncedSearchTerm:m,submit:h,reset:()=>{d=2,m.value="",i.value.query=""}}}}),yt={class:"menu menu-sub menu-sub-dropdown w-250px w-md-350px","data-kt-menu":"true"},xt=t("div",{class:"px-7 py-5"},[t("div",{class:"fs-5 text-dark fw-bold"},"Filter Options")],-1),Dt=t("div",{class:"separator border-gray-200"},null,-1),wt={class:"px-7 py-5"},kt={class:"mb-7"},Ft=t("label",{class:"form-label fw-semobold"},"T\xECm ki\u1EBFm:",-1),At={class:"d-flex align-items-center position-relative my-1"},Ct=t("div",{class:"separator my-2"},null,-1),$t={class:"d-flex justify-content-end"},Tt=t("button",{type:"submit",class:"btn btn-sm btn-primary","data-kt-menu-dismiss":"true"}," Apply ",-1);function St(e,o,d,h,m,F){const i=k("KTIcon");return C(),P("div",yt,[xt,Dt,t("div",wt,[t("div",kt,[Ft,t("div",At,[u(i,{"icon-name":"magnifier","icon-class":"fs-1 position-absolute ms-6"}),M(t("input",{type:"text","data-kt-subscription-table-filter":"search","onUpdate:modelValue":o[0]||(o[0]=v=>e.debouncedSearchTerm=v),class:"form-control form-control-solid w-100 ps-14",placeholder:"T\xECm ki\u1EBFm theo t\xEAn nh\xF3m"},null,512),[[ct,e.debouncedSearchTerm]])])]),Ct,t("div",$t,[t("button",{onClick:o[1]||(o[1]=(...v)=>e.reset&&e.reset(...v)),type:"reset",class:"btn btn-sm btn-outline btn-outline-dashed btn-outline-info me-2"}," Reset "),Tt])])])}const Pt=W(Et,[["render",St]]),Bt=j({name:"kt-target-group-list",components:{KTDatatable:rt,ErrorMessage:ut,Field:mt,VForm:_t,Fillter:Pt},directives:{debounce:z.exports.vue3Debounce({lock:!0})},setup(){const e=l([]),o=l(0),d=l(1),h=l(20),m=l(""),F=l(""),i=l(""),v=l(""),B=l(""),y=l(""),A=l(0),$=l(""),f=l({title:"",description:""}),x=L({title:""}),_=L({id:"",title:"",description:"",modified_at:"",service_count:"",target_count:"",created_at:"",flaw_count:""}),s=l(null),b=l(null),I=l(!1),Q=l([{columnName:"ID",columnLabel:"id",sortEnabled:!0},{columnName:"Nh\xF3m m\u1EE5c ti\xEAu",columnLabel:"title"},{columnName:"M\u1EE5c ti\xEAu",columnLabel:"target_count",sortEnabled:!0,columnWidth:100},{columnName:"L\u1ED7 h\u1ED5ng",columnLabel:"flaw_count",sortEnabled:!0,columnWidth:100},{columnName:"D\u1ECBch v\u1EE5",columnLabel:"service_count",sortEnabled:!0,columnWidth:100},{columnName:"Actions",columnLabel:"actions",columnWidth:50}]),X=(a,n)=>{y.value=n,x.title="",Object.keys(a).length!=0&&n==="edit"?($.value="Ch\u1EC9nh s\u1EEDa nh\xF3m m\u1EE5c ti\xEAu",f.value.title=a.title,f.value.description=a.description,A.value=a.id):($.value="Th\xEAm m\u1EDBi nh\xF3m m\u1EE5c ti\xEAu",s.value!==null&&s.value.click())},H=a=>{d.value=a!=null?a:1,g()},Z=a=>{d.value=1,h.value=a!=null?a:20,g()},g=()=>(I.value=!0,setTimeout(()=>I.value=!1,500),S.get(`targetgroup/index?search=${m.value}&page=${d.value}&page_size=${h.value}&orderingTarget=${i.value}&orderingID=${F.value}&orderingServer=${B.value}&orderingflaw=${v.value}`).then(({data:a})=>{e.value=a.results,o.value=a.count}).catch(({response:a})=>{p(a.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})),T=l([]),J=()=>{R(T.value)},N=l(null),R=a=>{if(a)return S.delete(`targetgroup/${a}`).then(({data:n})=>{p(n.detail,"success","X\xF3a th\xE0nh c\xF4ng"),d.value=1,T.value.length=0,g()}).catch(({response:n})=>{p(n.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})},Y=a=>{a.label&&(F.value=a.order==="asc"?`${a.label}`:`-${a.label}`),g()},tt=a=>{a?(_.id=a.id,_.title=a.title,_.description=a.description,_.modified_at=a.modified_at,_.service_count=a.service_count,_.target_count=a.target_count,_.created_at=a.created_at,_.flaw_count=a.flaw_count,new ht(document.getElementById("kt_modal_detail")).show()):p("","error","C\xF3 l\u1ED7i x\u1EA3y ra")},et=a=>{T.value=a},c=l(null),at=l(null),q=l(null),st=/^[ a-zA-Z0-9_ÀÁÂÃÈÉÊÌÍÒÓÔÕÙÚĂĐĨŨƠàáâãèéêìíòóôõùúăđĩũơƯĂẠẢẤẦẨẪẬẮẰẲẴẶẸẺẼỀỀỂưăạảấầẩẫậắằẳẵặẹẻẽềềểỄỆỈỊỌỎỐỒỔỖỘỚỜỞỠỢỤỦỨỪễệỉịọỏốồổỗộớờởỡợụủứừỬỮỰỲỴÝỶỸửữựỳỵỷỹ]+$/,ot=pt().shape({title:vt().min(3,"T\u1ED1i thi\u1EC3u 3 k\xED t\u1EF1").required("Vui l\xF2ng nh\u1EADp t\xEAn").matches(st,"T\xEAn nh\xF3m kh\xF4ng \u0111\u01B0\u1EE3c ch\u1EE9a k\xFD t\u1EF1 \u0111\u1EB7c bi\u1EC7t")}),p=(a,n,D)=>{ft.fire({text:a!=null?a:D,icon:n,buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{V(q.value),V(N.value),V(b.value)})},lt=async()=>{if(!c.value)return;let a={title:f.value.title,description:f.value.description};return y.value=="add"?S.post("/targetgroup",a).then(({data:n})=>{c.value&&(c.value.disabled=!0,c.value.setAttribute("data-kt-indicator","on"),setTimeout(()=>{var D;c.value&&(c.value.disabled=!1,(D=c.value)==null||D.removeAttribute("data-kt-indicator")),p(n.detail,"success","Th\xEAm m\u1EDBi th\xE0nh c\xF4ng"),g()},1e3))}).catch(({response:n})=>{n.data?x.title=n.data.title:p(n.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")}):S.put(`/targetgroup/${A.value}`,a).then(({data:n})=>{c.value&&(c.value.disabled=!0,c.value.setAttribute("data-kt-indicator","on"),setTimeout(()=>{var D;c.value&&(c.value.disabled=!1,(D=c.value)==null||D.removeAttribute("data-kt-indicator")),p(n.detail,"success","S\u1EEDa m\u1EDBi th\xE0nh c\xF4ng"),g()},1e3))}).catch(({response:n})=>{n.data?x.title=n.data.title:p(n.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})},nt=a=>{m.value=a.target.value,d.value=1},it=a=>{a?(m.value=a.query,d.value=1,g()):p("C\xF3 l\u1ED7i v\u1EDBi filter","error","C\xF3 l\u1ED7i x\u1EA3y ra")};return bt(()=>{g()}),{getData:g,list:e,headerConfig:Q,sort:Y,onItemSelect:et,selectedIds:T,deleteFewSubscriptions:J,deleteSubscription:R,getAssetPath:dt,apiData:f,validationSchema:ot,submit:lt,submitButtonRef:c,modalRef:at,newTargetGroupModalRef:q,handleClick:X,errors:x,ModalDelete:N,discardButtonRef:s,ModalDetail:b,customRowTable:tt,detailData:_,itemsPerPage:h,totalPage:o,currentPage:d,handlePage:H,handlePerPage:Z,query:m,setQuery:nt,handleFilter:it,nameType:$,loading:I}}}),It={class:"card h-100 d-block"},Vt={class:"card-header border-0 pt-6 position-absolute end-0 pe-1",style:{top:"-80px"}},Mt={class:"card-toolbar"},Nt={class:"d-flex justify-content-end","data-kt-subscription-table-toolbar":"base"},Rt={type:"button",class:"btn btn-sm fw-bold bg-body btn-color-gray-700 btn-active-color-primary me-2","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end","data-kt-menu-flip":"top-end"},qt={class:"d-flex justify-content-end align-items-center"},Ot={class:"fw-bold me-5"},Lt={class:"me-2"},Kt=t("button",{type:"button","data-bs-target":"#kt_modal_delete","data-bs-toggle":"modal",class:"btn btn-sm btn-danger"}," Delete Selected ",-1),Ut={class:"card-body pt-0 overflow-scroll h-100 p-0 m-0"},Gt={class:"fs-6 fw-bold text-dark text-hover-primary"},jt={class:"badge badge-light"},Wt={class:"badge badge-light"},zt={class:"badge badge-light"},Qt=["onClick"],Xt={class:"modal fade",tabindex:"-1",id:"kt_modal_new_target_group",ref:"newTargetGroupModalRef","aria-hidden":"true"},Ht={class:"modal-dialog modal-dialog-centered mw-650px"},Zt={class:"modal-content"},Jt={class:"modal-header",id:"kt_modal_new_target_group_header"},Yt={class:"btn btn-sm btn-icon btn-active-color-primary","data-bs-dismiss":"modal"},te={class:"modal-body py-10 px-lg-17"},ee={class:"scroll-y me-n7 pe-7",id:"kt_modal_new_target_group_scroll","data-kt-scroll":"true","data-kt-scroll-activate":"{default: false, lg: true}","data-kt-scroll-max-height":"auto","data-kt-scroll-dependencies":"#kt_modal_new_target_group_header","data-kt-scroll-wrappers":"#kt_modal_new_target_group_scroll","data-kt-scroll-offset":"300px"},ae={class:"mb-5 fv-row"},se=t("label",{class:"d-flex align-items-center fs-6 fw-semobold mb-2"},[t("span",{class:"required"},"T\xEAn nh\xF3m m\u1EE5c ti\xEAu"),t("i",{class:"fas fa-exclamation-circle ms-2 fs-7","data-bs-toggle":"tooltip",title:"B\u1EAFt bu\u1ED9c ph\u1EA3i nh\u1EADp"})],-1),oe={class:"fv-plugins-message-container"},le={class:"fv-help-block"},ne={key:0,class:""},ie={class:"d-flex flex-column mb-5 fv-row"},de=t("label",{class:"fs-6 fw-semobold mb-2"},"M\xF4 t\u1EA3 nh\xF3m m\u1EE5c ti\xEAu",-1),re={class:"fv-plugins-message-container"},ce={class:"fv-help-block"},ue={class:"modal-footer flex-center"},me={ref:"discardButtonRef",type:"reset",id:"kt_modal_new_target_group_cancel",class:"btn btn-sm btn-light me-3"},_e={ref:"submitButtonRef",type:"submit",id:"kt_modal_new_target_group_submit",class:"btn btn-sm btn-primary"},be=t("span",{class:"indicator-label"}," Submit ",-1),he=t("span",{class:"indicator-progress"},[E(" Please wait... "),t("span",{class:"spinner-border spinner-border-sm align-middle ms-2"})],-1),ge=[be,he],pe={class:"modal fade",tabindex:"-1",id:"kt_modal_delete",ref:"ModalDelete","aria-hidden":"true"},ve={class:"modal-dialog modal-dialog-centered"},fe={class:"modal-content"},Ee=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"X\xE1c nh\u1EADn x\xF3a nh\xF3m m\u1EE5c ti\xEAu"),t("div",{class:"btn btn-icon btn-sm btn-active-light-primary ms-2","data-bs-dismiss":"modal","aria-label":"Close"},[t("span",{class:"svg-icon svg-icon-2x"})])],-1),ye={class:"modal-body"},xe={key:0,class:"fw-bold"},De={class:"modal-footer"},we=t("button",{type:"button",class:"btn btn-sm btn-light","data-bs-dismiss":"modal"}," H\u1EE7y b\u1ECF ",-1),ke={class:"modal fade",tabindex:"-1",ref:"ModalDetail","aria-hidden":"true",id:"kt_modal_detail"},Fe={class:"modal-dialog modal-dialog-centered mw-650px"},Ae={class:"modal-content"},Ce={class:"modal-body"},$e={class:"card card-flush pt-3 mb-5 mb-xl-10"},Te={class:"card-header"},Se={class:"card-title"},Pe={class:"fw-bold"},Be={class:"card-toolbar"},Ie={class:"card-body py-0"},Ve={class:"mb-10"},Me=t("h5",null,"Th\xF4ng tin chi ti\u1EBFt:",-1),Ne={class:"d-flex flex-wrap py-5"},Re={class:"flex-equal me-5"},qe={class:"table fs-6 fw-semobold gs-0 gy-2 gx-2 m-0"},Oe=t("td",{class:"text-gray-400"},"S\u1ED1 m\u1EE5c ti\xEAu:",-1),Le={class:"text-gray-800 badge badge-light pe-2"},Ke=t("td",{class:"text-gray-400"},"S\u1ED1 l\u1ED7 h\u1ED5ng:",-1),Ue={class:"text-gray-800 badge badge-light pe-2"},Ge=t("td",{class:"text-gray-400"},"S\u1ED1 d\u1ECBch v\u1EE5:",-1),je={class:"text-gray-800 badge badge-light pe-2"},We=t("td",{class:"text-gray-400"},"Ng\xE0y t\u1EA1o:",-1),ze={class:"text-gray-800"},Qe=t("td",{class:"text-gray-400"},"Ng\xE0y c\u1EADp nh\u1EADt cu\u1ED1i:",-1),Xe={class:"text-gray-800"},He=t("label",{class:"fs-6 fw-semobold mb-2 text-gray-400"},"M\xF4 t\u1EA3:",-1),Ze={class:"fv-plugins-message-container"},Je={class:"fv-help-block"},Ye=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-sm btn-primary me-9","data-bs-dismiss":"modal"}," Quay l\u1EA1i ")],-1);function ta(e,o,d,h,m,F){var f,x,_;const i=k("KTIcon"),v=k("Fillter"),B=k("KTDatatable"),y=k("Field"),A=k("ErrorMessage"),$=k("VForm");return C(),P(gt,null,[t("div",It,[t("div",Vt,[t("div",Mt,[M(t("div",null,[t("div",Nt,[t("button",Rt,[u(i,{"icon-name":"filter","icon-class":"fs-2"}),E(" Filter ")]),u(v,{onFilterData:e.handleFilter},null,8,["onFilterData"]),t("button",{type:"button",class:"btn btn-sm fw-bold btn-primary","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClickPassive:o[0]||(o[0]=s=>e.handleClick({},"add"))},[u(i,{"icon-name":"plus","icon-class":"fs-2"}),E(" Th\xEAm ")],32)])],512),[[K,e.selectedIds.length===0]]),M(t("div",null,[t("div",qt,[t("div",Ot,[t("span",Lt,r(e.selectedIds.length),1),E("Selected ")]),Kt])],512),[[K,e.selectedIds.length!==0]])])]),t("div",Ut,[u(B,{onOnSort:e.sort,onOnItemsSelect:e.onItemSelect,data:e.list,header:e.headerConfig,loading:e.loading,"checkbox-enabled":!0,itemsPerPage:e.itemsPerPage,total:e.totalPage,currentPage:e.currentPage,onPageChange:e.handlePage,onOnItemsPerPageChange:e.handlePerPage,onCustomRow:e.customRowTable},{id:w(({row:s})=>[E(r(s.id),1)]),title:w(({row:s})=>[t("span",Gt,r(s.title),1)]),target_count:w(({row:s})=>{var b;return[t("div",jt,r((b=s.target_count)!=null?b:0),1)]}),flaw_count:w(({row:s})=>{var b;return[t("div",Wt,r((b=s.flaw_count)!=null?b:0),1)]}),service_count:w(({row:s})=>{var b;return[t("div",zt,r((b=s.service_count)!=null?b:0),1)]}),actions:w(({row:s})=>[t("button",{type:"button",class:"btn btn-icon btn-bg-light btn-active-color-warning btn-sm me-1","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClick:b=>e.handleClick(s,"edit"),title:"S\u1EEDa"},[u(i,{"icon-name":"pencil","icon-class":"fs-3"})],8,Qt)]),_:1},8,["onOnSort","onOnItemsSelect","data","header","loading","itemsPerPage","total","currentPage","onPageChange","onOnItemsPerPageChange","onCustomRow"])])]),t("div",Xt,[t("div",Ht,[t("div",Zt,[t("div",Jt,[t("h2",null,r(e.nameType),1),t("div",Yt,[u(i,{"icon-name":"cross","icon-class":"fs-1"})])]),u($,{id:"kt_modal_new_target_group_form",class:"form",onSubmit:e.submit,"validation-schema":e.validationSchema},{default:w(()=>[t("div",te,[t("div",ee,[t("div",ae,[se,u(y,{type:"text",class:"form-control form-control-solid",placeholder:"Nh\u1EADp nh\xF3m m\u1EE5c ti\xEAu",name:"title",modelValue:e.apiData.title,"onUpdate:modelValue":o[1]||(o[1]=s=>e.apiData.title=s)},null,8,["modelValue"]),t("div",oe,[t("div",le,[u(A,{name:"title"}),e.errors.title?(C(),P("span",ne,r(e.errors.title[0]),1)):U("",!0)])])]),t("div",ie,[de,u(y,{as:"textarea",class:"form-control form-control-solid",rows:"5",name:"description",placeholder:"Nh\u1EADp m\xF4 t\u1EA3 nh\xF3m m\u1EE5c ti\xEAu",modelValue:e.apiData.description,"onUpdate:modelValue":o[2]||(o[2]=s=>e.apiData.description=s)},null,8,["modelValue"]),t("div",re,[t("div",ce,[u(A,{name:"description"})])])])])]),t("div",ue,[t("button",me," Discard ",512),t("button",_e,ge,512)])]),_:1},8,["onSubmit","validation-schema"])])])],512),t("div",pe,[t("div",ve,[t("div",fe,[Ee,t("div",ye,[t("p",null,[E("B\u1EA1n c\xF3 ch\u1EAFc ch\u1EAFn mu\u1ED1n x\xF3a "),e.selectedIds.length>0?(C(),P("span",xe,r(e.selectedIds.length),1)):U("",!0),E(" b\u1EA3n ghi n\xE0y kh\xF4ng?.")])]),t("div",De,[we,t("button",{type:"button",class:"btn btn-sm btn-primary",onClickPassive:o[3]||(o[3]=s=>e.deleteFewSubscriptions())}," \u0110\u1ED3ng \xFD ",32)])])])],512),t("div",ke,[t("div",Fe,[t("div",Ae,[t("div",Ce,[t("div",$e,[t("div",Te,[t("div",Se,[t("h1",Pe,r(e.detailData.title),1)]),t("div",Be,[t("button",{type:"button",class:"btn btn-light-warning btn-sm me-1","data-bs-toggle":"modal","data-bs-target":"#kt_modal_new_target_group",onClick:o[4]||(o[4]=s=>e.handleClick(e.detailData,"edit"))},[u(i,{"icon-name":"pencil","icon-class":"fs-3"}),E(" Update ")])])]),t("div",Ie,[t("div",Ve,[Me,t("div",Ne,[t("div",Re,[t("table",qe,[t("tr",null,[Oe,t("td",Le,r((f=e.detailData.target_count)!=null?f:0),1)]),t("tr",null,[Ke,t("td",Ue,r((x=e.detailData.flaw_count)!=null?x:0),1)]),t("tr",null,[Ge,t("td",je,r((_=e.detailData.service_count)!=null?_:0),1)]),t("tr",null,[We,t("td",ze,r(e.detailData.created_at),1)]),t("tr",null,[Qe,t("td",Xe,r(e.detailData.modified_at),1)])]),He,e.detailData.description?(C(),G(y,{key:0,as:"textarea",class:"form-control form-control-solid",rows:"5",name:"description",modelValue:e.detailData.description,"onUpdate:modelValue":o[5]||(o[5]=s=>e.detailData.description=s),disabled:""},null,8,["modelValue"])):(C(),G(y,{key:1,as:"textarea",class:"form-control form-control-solid",rows:"5",name:"description",modelValue:e.detailData.description,"onUpdate:modelValue":o[6]||(o[6]=s=>e.detailData.description=s),disabled:"",placeholder:"Ch\u01B0a c\xF3 m\xF4 t\u1EA3"},null,8,["modelValue"])),t("div",Ze,[t("div",Je,[u(A,{name:"description"})])])])])])])])]),Ye])])],512)],64)}const da=W(Bt,[["render",ta]]);export{da as default};
