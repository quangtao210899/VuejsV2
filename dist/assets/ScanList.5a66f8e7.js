import{g as ke}from"./assets.627312db.js";import{D as Ce}from"./KTDataTable.c389d200.js";import{d as le,A as r,af as U,_ as oe,r as C,i as v,k as e,q as a,w as o,o as h,I as d,a7 as Se,a6 as $e,au as Fe,av as X,x as se,aw as R,as as Ie,az as Le,l as p,p as V,H as P,n as g,F as ae,j as Me}from"./index.69b36d76.js";import{h as Ae}from"./dom.77db5301.js";import{v as W}from"./vue-debounce.min.43c24b86.js";import{S as Ve}from"./sweetalert2.242d9dda.js";import{C as Pe}from"./CodeHighlighter.b2d3f0b2.js";import"./documentation.5bc44fc8.js";import"./clipboard.b86e1ca9.js";const qe=le({name:"filter-scan",components:{},emits:["filter-data"],setup(t,{emit:l}){var k=0;const y=async()=>{if(u.value.ip!=D.value){u.value.ip=D.value;return}if(u.value.domain!=n.value){u.value.domain=n.value;return}k&&(k--,k==0||k==1)||l("filter-data",u.value)},D=r(""),I=W.exports.debounce(y,1e3),n=r(""),w=W.exports.debounce(y,1e3),u=r({status:"",severity:"",ip:"",typeIp:"equal",domain:"",typeDomain:"equal"});return U(D,I),U(n,w),U(u.value,()=>{y()}),{data:u,debouncedSearchIp:D,debouncedSearchDomain:n,submit:y,reset:()=>{k=3,D.value="",n.value="",u.value.status="",u.value.severity="",u.value.ip="",u.value.typeIp="equal",u.value.domain="",u.value.typeDomain="equal"}}}});const xe={class:"menu menu-sub menu-sub-dropdown w-250px w-md-350px","data-kt-menu":"true"},He=e("div",{class:"px-7 py-5"},[e("div",{class:"fs-5 text-dark fw-bold"},"Filter Options")],-1),Te=e("div",{class:"separator border-gray-200"},null,-1),Ne={class:"px-7 py-5"},Ue={class:"mb-7"},Xe=e("label",{class:"form-label fw-semobold"},"Tr\u1EA1ng th\xE1i:",-1),Re={class:"mb-7"},We=e("label",{class:"form-label fw-semobold"},"M\u1EE9c \u0111\u1ED9 l\u1ED7 h\u1ED5ng:",-1),ze={class:"mb-7"},Be=e("label",{class:"form-label fw-semobold"},"IP:",-1),Oe={class:"row"},je={class:"col-8 pe-0"},Ke={class:"col-4"},Ye={class:"mb-7"},Ge=e("label",{class:"form-label fw-semobold"},"Domain:",-1),Je={class:"row"},Qe={class:"col-8 pe-0"},Ze={class:"col-4"},et=e("div",{class:"separator my-2"},null,-1),tt={class:"d-flex justify-content-end"},st=e("button",{type:"submit",class:"btn btn-sm btn-primary","data-kt-menu-dismiss":"true"}," Apply ",-1);function at(t,l,k,y,D,I){const n=C("el-option"),w=C("el-select"),u=C("el-form-item"),b=C("el-input");return h(),v("div",xe,[He,Te,e("div",Ne,[e("div",Ue,[Xe,e("div",null,[a(u,{prop:"assign"},{default:o(()=>[a(w,{modelValue:t.data.status,"onUpdate:modelValue":l[0]||(l[0]=_=>t.data.status=_),name:"status",as:"select",placeholder:"Ch\u1ECDn tr\u1EA1ng th\xE1i"},{default:o(()=>[a(n,{value:""},{default:o(()=>[d("Ch\u1ECDn tr\u1EA1ng th\xE1i")]),_:1}),a(n,{label:"open",value:"open"},{default:o(()=>[d("open")]),_:1}),a(n,{label:"re-open",value:"re-open"},{default:o(()=>[d("re-open")]),_:1}),a(n,{label:"Close",value:"closed"},{default:o(()=>[d("Close")]),_:1}),a(n,{label:"Accepted",value:"rick-accepted"},{default:o(()=>[d("Accepted")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("div",Re,[We,e("div",null,[a(u,{prop:"assign"},{default:o(()=>[a(w,{modelValue:t.data.severity,"onUpdate:modelValue":l[1]||(l[1]=_=>t.data.severity=_),name:"severity",as:"select",placeholder:"Ch\u1ECDn m\u1EE9c \u0111\u1ED9 l\u1ED7 h\u1ED5ng"},{default:o(()=>[a(n,{value:""},{default:o(()=>[d("Ch\u1ECDn l\u1ED7 h\u1ED5ng")]),_:1}),a(n,{label:"Info",value:"0"},{default:o(()=>[d("Info")]),_:1}),a(n,{label:"Low",value:"1"},{default:o(()=>[d("Low")]),_:1}),a(n,{label:"Medium",value:"2"},{default:o(()=>[d("Medium")]),_:1}),a(n,{label:"High",value:"3"},{default:o(()=>[d("High")]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),e("div",ze,[Be,e("div",Oe,[e("div",je,[a(b,{modelValue:t.debouncedSearchIp,"onUpdate:modelValue":l[2]||(l[2]=_=>t.debouncedSearchIp=_),type:"text",placeholder:"Nh\u1EADp IP",name:"targetTitle",class:"h-40px"},null,8,["modelValue"])]),e("div",Ke,[a(u,{prop:"assign"},{default:o(()=>[a(w,{modelValue:t.data.typeIp,"onUpdate:modelValue":l[3]||(l[3]=_=>t.data.typeIp=_),name:"typeIp",as:"select"},{default:o(()=>[a(n,{value:"equal",label:"Equal"},{default:o(()=>[d("Equal")]),_:1}),a(n,{label:"NContains",value:"not_contains"},{default:o(()=>[d("NContains")]),_:1}),a(n,{label:"contains",value:"contains"},{default:o(()=>[d("contains")]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),e("div",Ye,[Ge,e("div",Je,[e("div",Qe,[a(b,{modelValue:t.debouncedSearchDomain,"onUpdate:modelValue":l[4]||(l[4]=_=>t.debouncedSearchDomain=_),type:"text",placeholder:"Nh\u1EADp Domain",name:"targetTitle",class:"h-40px"},null,8,["modelValue"])]),e("div",Ze,[a(u,{prop:"assign"},{default:o(()=>[a(w,{modelValue:t.data.typeDomain,"onUpdate:modelValue":l[5]||(l[5]=_=>t.data.typeDomain=_),name:"typeDomain",as:"select"},{default:o(()=>[a(n,{value:"equal",label:"Equal"},{default:o(()=>[d("Equal")]),_:1}),a(n,{label:"NContains",value:"not_contains"},{default:o(()=>[d("NContains")]),_:1}),a(n,{label:"contains",value:"contains"},{default:o(()=>[d("contains")]),_:1})]),_:1},8,["modelValue"])]),_:1})])])]),et,e("div",tt,[e("button",{onClick:l[6]||(l[6]=(..._)=>t.reset&&t.reset(..._)),type:"reset",class:"btn btn-sm btn-outline btn-outline-dashed btn-outline-info me-2"}," Reset "),st])])])}const lt=oe(qe,[["render",at]]),ot=le({name:"kt-scans-list",components:{KTDatatable:Ce,ErrorMessage:Se,Field:$e,VForm:Fe,Fillter:lt,CodeHighlighter:Pe},directives:{debounce:W.exports.vue3Debounce({lock:!0})},setup(){const t=r([]),l=r(!1),k=r(0),y=r(1),D=r(20),I=r(""),n=r(""),w=r(""),u=r(""),b=r(""),_=r(""),L=r(""),i=r("");r(0);const f=r(""),T=r(!1),z=r({title:"",description:""}),q=X({severity:"",status:""}),c=X({id:"",vt_name:"",severity:"",ip:"",hostname:"",schema:"",created_at:"",status:"",last_seen:"",url:"",parameter:"",tags:"",cvss_score:"",details:"",description:"",request:"",http_response:"",recommendation:""}),ne=r([{columnName:"Sev",columnLabel:"severity"},{columnName:"T\xEAn",columnLabel:"vt_name"},{columnName:"Host name",columnLabel:"hostname"},{columnName:"IP",columnLabel:"ip"},{columnName:"Service",columnLabel:"schema"},{columnName:"Ng\xE0y T\u1EA1o",columnLabel:"created_at"},{columnName:"Tr\u1EA1ng th\xE1i",columnLabel:"status"}]),ie=(s,m)=>{i.value=m,z.value.description=s.description},de=s=>{y.value=s!=null?s:1,S()},re=s=>{D.value=s!=null?s:20,S()},S=()=>(l.value=!0,setTimeout(()=>l.value=!1,500),R.get(`vuls/index?page=${y.value}&page_size=${D.value}&status=${n.value}&severity=${w.value}&ip=${u.value}&search_ip_type=${_.value}&domain=${b.value}&search_domain_type=${L.value}`).then(({data:s})=>{t.value=s.results,k.value=s.count}).catch(({response:s})=>{$(s.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})),x=r([]),ce=()=>{O(x.value)},B=r(null),O=s=>{if(s){let m={id:s};return R.post("vuls/multi_delete",m).then(({data:E})=>{$(E.detail,"success","X\xF3a th\xE0nh c\xF4ng"),x.value.length=0,S()}).catch(({response:E})=>{$(E.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})}},ue=s=>{var m,E,M,A,te;T.value=!0,c.id=s.id,c.vt_name=(m=s.vt_name)!=null?m:s.port_scan.name,c.status=s.status,c.severity=String(s.severity),c.created_at=s.created_at,c.hostname=s.hostname,c.ip=(E=s.ip)!=null?E:s.port_scan.in_cpe,c.schema=s.schema,c.last_seen=s.last_seen,c.url=(M=s.host)!=null?M:s.port_scan.host,c.parameter=s.affects_detail,c.tags=(A=s.tags)!=null?A:s.port_scan.tags,c.cvss_score=s.cvss_score,c.details=s.details,c.description=(te=s.description)!=null?te:s.port_scan.description,c.request=s.request,c.http_response=s.http_response,c.recommendation=s.recommendation,q.severity=c.severity,q.status=c.status,console.log(c.severity)},me=()=>{T.value=!1},j=r(null),K=r("#kt_modal_confirm"),Y=r(null),pe=s=>{if(c.status&&c.severity&&s){Y.value=s;const m=new Ie(K.value);m.show(),j.value=m}else $("","error","C\xF3 l\u1ED7i x\u1EA3y ra")},ve=()=>{c.status=q.status,c.severity=q.severity},he=async()=>{j.value.hide();let s={severity:c.severity,status:c.status};return R.put(`/vuls/${c.id}/update`,s).then(({data:m})=>{$(m.detail,"success","Update th\xE0nh c\xF4ng"),S()}).catch(({response:m})=>{$(m.data.detail,"error","C\xF3 l\u1ED7i x\u1EA3y ra")})},_e=s=>{console.log(s)},be=s=>{x.value=s},$=(s,m,E)=>{Ve.fire({text:s!=null?s:E,icon:m,buttonsStyling:!1,confirmButtonText:"Ok, got it!",heightAuto:!1,customClass:{confirmButton:"btn btn-primary"}}).then(()=>{Ae(B.value)})},fe=s=>{if(s==="false"||s==="null")return"--:--";const m="DD/MM/YYYY HH:mm:ss";return Le(s).format(m)},ge=s=>s==0?{id:0,title:"Info",color:"#28a745",class:"severityInfo"}:s==1?{id:1,title:"Low",color:"#23b7e5",class:"severityLow"}:s==2?{id:2,title:"Medium",color:"#fcba32",class:"severityMedium"}:s==3?{id:3,title:"High",color:"#e11f26",class:"severityHigh"}:{id:4,title:"undefined",color:"light",class:"severityundefined"},ye=s=>s==="open"?{id:3,title:"Open",color:"success"}:s==="re-open"?{id:5,title:"Reopen",color:"primary"}:s==="closed"?{id:6,title:"Close",color:"danger"}:s==="rick-accepted"?{id:7,title:"Accepted",color:"info"}:{id:8,title:"undefined",color:"light"},De=s=>{s?(n.value=s.status,w.value=s.severity,u.value=s.ip,b.value=s.domain,_.value=s.typeIp,L.value=s.typeDomain,y.value=1,S()):$("C\xF3 l\u1ED7i v\u1EDBi filter","error","C\xF3 l\u1ED7i x\u1EA3y ra")},G=r(window.innerWidth/2),J=r(window.innerWidth/2);let N=r(null);const we=s=>{N=s.clientX;const m=M=>{const A=M.clientX-N;G.value+=A,J.value-=A,N=M.clientX},E=()=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",E)};window.addEventListener("mousemove",m),window.addEventListener("mouseup",E)},H=r(null),F=X({isDragging:!1,startX:0,startScrollLeft:0}),Ee=s=>{F.isDragging=!0,F.startX=s.clientX,F.startScrollLeft=H.value.scrollLeft,window.addEventListener("mousemove",Q),window.addEventListener("mouseup",Z)},Q=s=>{if(!F.isDragging)return;const m=s.clientX-F.startX;H.value.scrollLeft=F.startScrollLeft-m},Z=()=>{F.isDragging=!1,window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",Z)},ee=r(0);return se(()=>{ee.value=H.value.scrollWidth}),se(()=>{S()}),{getData:S,list:t,headerConfig:ne,onItemSelect:be,selectedIds:x,deleteFewSubscriptions:ce,deleteSubscription:O,getAssetPath:ke,apiData:z,handleClick:ie,ModalDelete:B,customRowTable:ue,itemsPerPage:D,totalPage:k,currentPage:y,handlePage:de,handlePerPage:re,query:I,nameType:f,getSeverity:ge,formatDate:fe,getStatus:ye,handleFilter:De,loading:l,classDetail:T,detailData:c,handleCloseDetail:me,handleChangeUpdate:pe,updateData:he,ModalConfirm:K,typeConfirm:Y,testModal:_e,quitUpdateData:ve,startDragging:we,leftWidth:G,rightWidth:J,handleMouseDown:Ee,contentWidth:ee,container:H}}});const nt={class:"card h-100 d-block"},it={class:"card-header border-0 pt-6 position-absolute end-0 pe-1",style:{top:"-80px"}},dt={class:"card-toolbar"},rt={key:0,class:"d-flex justify-content-end","data-kt-subscription-table-toolbar":"base"},ct={type:"button",class:"btn btn-sm fw-bold bg-body btn-color-gray-700 btn-active-color-primary","data-kt-menu-trigger":"click","data-kt-menu-placement":"bottom-end","data-kt-menu-flip":"top-end"},ut={key:1,class:"d-flex justify-content-end align-items-center"},mt={class:"fw-bold me-5"},pt={class:"me-2"},vt={type:"button","data-bs-target":"#kt_modal_delete","data-bs-toggle":"modal",class:"btn btn-danger btn-sm"},ht={class:"text-center"},_t=e("br",null,null,-1),bt={class:"fs-6 fw-bold text-dark text-hover-primary"},ft={class:"badge badge-light"},gt={class:"badge badge-light"},yt={class:"badge badge-light-primary"},Dt={class:"text-gray-600 w-bold d-flex justify-content-end align-items-center fs-7"},wt={class:"ms-3 pb-10"},Et={class:"card-title py-5 position-relative"},kt={class:"fw-bold pe-15 mt-5"},Ct={class:"position-absolute top-50 end-0 translate-middle-y"},St={class:"row"},$t={class:"col-4"},Ft={class:"col-4"},It={class:"bg-light my-3 py-2 px-4 lh-lg rounded-2 me-2"},Lt={class:"row"},Mt={class:"col-12 col-xl-6 col-xxl-4"},At=e("label",{class:"text-black-50",for:"IP"},"IP : ",-1),Vt={class:"ps-1"},Pt={class:"col-12 col-xl-6 col-xxl-4"},qt=e("label",{class:"text-black-50",for:"Host name"},"Host name : ",-1),xt={class:"ps-1"},Ht={class:"col-12 col-xl-6 col-xxl-4"},Tt=e("label",{class:"text-black-50",for:"Date"},"Date : ",-1),Nt={class:"ps-1"},Ut={class:"lh-lg"},Xt={key:0,class:"mb-5"},Rt=e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Vulnerable URL",-1),Wt={key:0},zt=e("label",{style:{width:"100px"},for:"Host name"},"URL : ",-1),Bt={class:"ps-1"},Ot=["href"],jt={key:1},Kt=e("label",{style:{width:"100px"},for:"Host name"},"Parameter : ",-1),Yt={class:"ps-1"},Gt={key:1,class:"mb-5"},Jt=e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"CVE/CWE",-1),Qt={class:"lh-base"},Zt=e("span",{class:"bullet bullet-vertical bg-primary me-5"},null,-1),es={key:2,class:"mb-5"},ts=e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"CVSS Score",-1),ss={class:"d-flex align-items-center py-2"},as=e("span",{class:"bullet bg-warning me-5"},null,-1),ls=e("label",{for:"Host name"},"Base Score: ",-1),os={key:3,class:"mb-5"},ns=e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Attack Details",-1),is=["innerHTML"],ds={key:4,class:"mb-5"},rs=e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Description",-1),cs=["innerHTML"],us={class:""},ms={id:"kt_detail_collapsible_scan"},ps={key:0,class:"py-1"},vs={class:"py-3 d-flex flex-stack flex-wrap"},hs={class:"d-flex align-items-center collapsible toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#kt_detail_collapsible_scan_1","aria-expanded":"false"},_s={class:"btn btn-sm btn-icon btn-active-color-primary ms-n3 me-2"},bs=e("div",{class:"me-3"},[e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Request")],-1),fs={id:"kt_detail_collapsible_scan_1",class:"fs-6 px-2 collapse",style:{}},gs={key:1,class:"separator separator-dashed"},ys={key:2,class:"py-1"},Ds={class:"py-3 d-flex flex-stack flex-wrap"},ws={class:"d-flex align-items-center collapsible toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#kt_detail_collapsible_scan_2"},Es={class:"btn btn-sm btn-icon btn-active-color-primary ms-n3 me-2"},ks=e("div",{class:"me-3"},[e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Response")],-1),Cs={id:"kt_detail_collapsible_scan_2",class:"collapse fs-6 px-2"},Ss={key:3,class:"separator separator-dashed"},$s={key:4,class:"py-1"},Fs={class:"py-3 d-flex flex-stack flex-wrap"},Is={class:"d-flex align-items-center collapsible toggle collapsed","data-bs-toggle":"collapse","data-bs-target":"#kt_detail_collapsible_scan_3"},Ls={class:"btn btn-sm btn-icon btn-active-color-primary ms-n3 me-2"},Ms=e("div",{class:"me-3"},[e("h4",{class:"text-gray-700 fw-bold cursor-pointer mb-0"},"Resolution")],-1),As={id:"kt_detail_collapsible_scan_3",class:"collapse fs-6 px-2"},Vs={class:"modal fade",tabindex:"-1",id:"kt_modal_delete",ref:"ModalDelete","aria-hidden":"true"},Ps={class:"modal-dialog modal-dialog-centered"},qs={class:"modal-content"},xs=e("div",{class:"modal-header"},[e("h5",{class:"modal-title"},"X\xE1c nh\u1EADn x\xF3a recon"),e("div",{class:"btn btn-icon btn-sm btn-active-light-primary ms-2","data-bs-dismiss":"modal","aria-label":"Close"},[e("span",{class:"svg-icon svg-icon-2x"})])],-1),Hs={class:"modal-body"},Ts={key:0,class:"fw-bold"},Ns={class:"modal-footer"},Us=e("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal"}," H\u1EE7y b\u1ECF ",-1),Xs={class:"modal-dialog modal-dialog-centered"},Rs={class:"modal-content"},Ws={class:"modal-body"},zs={class:"fw-bold text-danger"},Bs={class:"fw-bold text-danger"},Os={class:"modal-footer"};function js(t,l,k,y,D,I){const n=C("KTIcon"),w=C("Fillter"),u=C("KTDatatable"),b=C("el-option"),_=C("el-select"),L=C("CodeHighlighter");return h(),v(ae,null,[e("div",nt,[e("div",it,[e("div",dt,[t.selectedIds.length===0?(h(),v("div",rt,[e("button",ct,[a(n,{"icon-name":"filter","icon-class":"fs-2"}),d(" Filter ")]),a(w,{onFilterData:t.handleFilter},null,8,["onFilterData"])])):(h(),v("div",ut,[e("div",mt,[e("span",pt,p(t.selectedIds.length),1),d("Selected ")]),e("button",vt,[a(n,{"icon-name":"detele","icon-class":"bi bi-trash",style:{fontSize:"16px"}}),d(" Delete Selected ")])]))])]),e("div",{class:V(["d-flex hand-height-2 shadow-hvover",t.classDetail?"py-2 ps-2 pe-1":""])},[e("div",{class:V(["card-body overflow-auto h-100 m-0",t.classDetail?"d-block border-end p-3":"col-12 d-block p-0"]),ref:"container",onMousedown:l[0]||(l[0]=(...i)=>t.handleMouseDown&&t.handleMouseDown(...i)),style:P(t.classDetail?{width:t.leftWidth+"px"}:{width:"100%"})},[e("div",{style:P({width:t.contentWidth+"px"})},[a(u,{onOnItemsSelect:t.onItemSelect,data:t.list,header:t.headerConfig,loading:t.loading,"checkbox-enabled":!0,itemsPerPage:t.itemsPerPage,total:t.totalPage,currentPage:t.currentPage,onPageChange:t.handlePage,onOnItemsPerPageChange:t.handlePerPage,onCustomRow:t.customRowTable},{severity:o(({row:i})=>[e("div",ht,[a(n,{"icon-name":"severity","icon-class":"bi bi-bug-fill",style:P({fontSize:"19px",color:t.getSeverity(i.severity).color})},null,8,["style"]),_t,e("p",{class:"fst-normal",style:P({fontSize:"11px",color:t.getSeverity(i.severity).color})},p(t.getSeverity(i.severity).title),5)])]),vt_name:o(({row:i})=>{var f;return[e("span",bt,p((f=i.vt_name)!=null?f:"--"),1)]}),hostname:o(({row:i})=>{var f;return[e("div",ft,p((f=i.hostname)!=null?f:"--"),1)]}),ip:o(({row:i})=>[e("div",gt,p(i.ip==""?"--":i.ip),1)]),schema:o(({row:i})=>{var f;return[e("div",null,[e("span",yt,p((f=i.schema)!=null?f:"--"),1)])]}),created_at:o(({row:i})=>[e("span",Dt,[a(n,{class:"me-1","icon-name":"calendar","icon-class":"fs-3"}),d(" "+p(t.formatDate(i.created_at)),1)])]),status:o(({row:i})=>{var f;return[e("div",null,[e("span",{class:V(`badge badge-${t.getStatus(i.status).color}`)},p((f=i.status)!=null?f:"--"),3)])]}),_:1},8,["onOnItemsSelect","data","header","loading","itemsPerPage","total","currentPage","onPageChange","onOnItemsPerPageChange","onCustomRow"])],4)],38),t.classDetail?(h(),v("div",{key:0,onMousedown:l[1]||(l[1]=(...i)=>t.startDragging&&t.startDragging(...i)),class:"drag-handle"},null,32)):g("",!0),e("div",{class:V(["overflow-scroll h-100",t.classDetail?" d-block":"d-none"]),style:P(t.classDetail?{width:t.rightWidth+"px"}:{width:"0px"})},[e("div",wt,[e("div",Et,[e("h2",kt,p(t.detailData.vt_name),1),e("div",Ct,[e("button",{onClick:l[2]||(l[2]=(...i)=>t.handleCloseDetail&&t.handleCloseDetail(...i)),type:"button",class:"btn btn-icon btn-bg-body"},[a(n,{"icon-name":"x","icon-class":"bi bi-x",style:{fontSize:"25px"}})])])]),e("div",St,[e("div",$t,[a(_,{name:"severity",as:"select",modelValue:t.detailData.severity,"onUpdate:modelValue":l[3]||(l[3]=i=>t.detailData.severity=i),class:V(t.getSeverity(t.detailData.severity).class),onChange:l[4]||(l[4]=i=>t.handleChangeUpdate("M\u1EE9c \u0111\u1ED9"))},{default:o(()=>[a(b,{label:"Info",value:"0",key:"0"},{default:o(()=>[d("Info")]),_:1}),a(b,{label:"Low",value:"1",key:"1"},{default:o(()=>[d("Low")]),_:1}),a(b,{label:"Medium",value:"2",key:"2"},{default:o(()=>[d("Medium")]),_:1}),a(b,{label:"High",value:"3",key:"3"},{default:o(()=>[d("High")]),_:1})]),_:1},8,["modelValue","class"])]),e("div",Ft,[a(_,{name:"status",as:"select",modelValue:t.detailData.status,"onUpdate:modelValue":l[5]||(l[5]=i=>t.detailData.status=i),onChange:l[6]||(l[6]=i=>t.handleChangeUpdate("Tr\u1EA1ng Th\xE1i"))},{default:o(()=>[a(b,{label:"open",value:"open",key:"open"},{default:o(()=>[d("open")]),_:1}),a(b,{label:"re-open",value:"re-open",key:"re-open"},{default:o(()=>[d("re-open")]),_:1}),a(b,{label:"Close",value:"closed",key:"closed"},{default:o(()=>[d("Close")]),_:1}),a(b,{label:"Accepted",value:"rick-accepted",key:"rick-accepted"},{default:o(()=>[d("Accepted")]),_:1})]),_:1},8,["modelValue"])])]),e("div",It,[e("div",Lt,[e("div",Mt,[At,e("span",Vt,p(t.detailData.ip),1)]),e("div",Pt,[qt,e("span",xt,p(t.detailData.hostname),1)]),e("div",Ht,[Tt,e("span",Nt,p(t.formatDate(t.detailData.last_seen)),1)])])]),e("div",Ut,[t.detailData.url!=null&&t.detailData.url!=""||t.detailData.parameter!=null&&t.detailData.parameter!=""?(h(),v("div",Xt,[Rt,t.detailData.url!=null&&t.detailData.url!=""?(h(),v("div",Wt,[zt,e("span",Bt,[e("a",{target:"_blank",href:`${t.detailData.url}`,class:"text-primary"},[a(n,{"icon-name":"link","icon-class":"bi bi-link-45deg",style:{fontSize:"16px"}}),d(" "+p(t.detailData.url),1)],8,Ot)])])):g("",!0),t.detailData.parameter!=null&&t.detailData.parameter!=""?(h(),v("div",jt,[Kt,e("span",Yt,p(t.detailData.parameter),1)])):g("",!0)])):g("",!0),t.detailData.tags!=null&&t.detailData.tags!=""?(h(),v("div",Gt,[Jt,e("div",Qt,[(h(!0),v(ae,null,Me(t.detailData.tags,(i,f)=>(h(),v("li",{key:f,class:"d-flex align-items-center py-2"},[Zt,d(" "+p(i),1)]))),128))])])):g("",!0),t.detailData.cvss_score!=null&&t.detailData.cvss_score!=""?(h(),v("div",es,[ts,e("div",null,[e("li",ss,[as,ls,e("strong",null,p(t.detailData.cvss_score),1)])])])):g("",!0),t.detailData.details!=null&&t.detailData.details!=""?(h(),v("div",os,[ns,e("div",null,[e("div",{class:"ps-1",innerHTML:t.detailData.details},null,8,is)])])):g("",!0),t.detailData.description!=null&&t.detailData.description!=""?(h(),v("div",ds,[rs,e("div",null,[e("div",{class:"ps-1",innerHTML:t.detailData.description},null,8,cs)])])):g("",!0)]),e("div",us,[e("div",ms,[t.detailData.request!=null&&t.detailData.request!=""?(h(),v("div",ps,[e("div",vs,[e("div",hs,[e("div",_s,[a(n,{"icon-name":"minus-square","icon-class":"toggle-on text-primary fs-2"}),a(n,{"icon-name":"plus-square","icon-class":"toggle-off fs-2"})]),bs])]),e("div",fs,[e("div",null,[a(L,{lang:"json"},{default:o(()=>[d(p(t.detailData.request),1)]),_:1})])])])):g("",!0),t.detailData.request!=null&&t.detailData.request!=""?(h(),v("div",gs)):g("",!0),t.detailData.http_response!=null&&t.detailData.http_response!=""?(h(),v("div",ys,[e("div",Ds,[e("div",ws,[e("div",Es,[a(n,{"icon-name":"minus-square","icon-class":"toggle-on text-primary fs-2"}),a(n,{"icon-name":"plus-square","icon-class":"toggle-off fs-2"})]),ks])]),e("div",Cs,[e("div",null,[a(L,{lang:"html"},{default:o(()=>[d(p(t.detailData.http_response),1)]),_:1})])])])):g("",!0),t.detailData.http_response!=null&&t.detailData.http_response!=""?(h(),v("div",Ss)):g("",!0),t.detailData.recommendation!=null&&t.detailData.recommendation!=""?(h(),v("div",$s,[e("div",Fs,[e("div",Is,[e("div",Ls,[a(n,{"icon-name":"minus-square","icon-class":"toggle-on text-primary fs-2"}),a(n,{"icon-name":"plus-square","icon-class":"toggle-off fs-2"})]),Ms])]),e("div",As,[e("div",null,p(t.detailData.recommendation),1)])])):g("",!0)])])])],6)],2)]),e("div",Vs,[e("div",Ps,[e("div",qs,[xs,e("div",Hs,[e("p",null,[d("B\u1EA1n c\xF3 ch\u1EAFc ch\u1EAFn mu\u1ED1n x\xF3a "),t.selectedIds.length>0?(h(),v("span",Ts,p(t.selectedIds.length),1)):g("",!0),d(" b\u1EA3n ghi n\xE0y kh\xF4ng?.")])]),e("div",Ns,[Us,e("button",{type:"button",class:"btn btn-primary",onClickPassive:l[7]||(l[7]=i=>t.deleteFewSubscriptions())}," \u0110\u1ED3ng \xFD ",32)])])])],512),e("div",{class:"modal fade",tabindex:"-1",onVOn:l[10]||(l[10]=(...i)=>t.testModal&&t.testModal(...i)),ref:"Modalconfirm","aria-hidden":"true",id:"kt_modal_confirm"},[e("div",Xs,[e("div",Rs,[e("div",Ws,[e("p",null,[d("B\u1EA1n c\xF3 ch\u1EAFc ch\u1EAFn mu\u1ED1n thay \u0111\u1ED5i "),e("span",zs,p(t.typeConfirm),1),d(" l\u1ED7 h\u1ED5ng c\u1EE7a b\u1EA3n gi "),e("span",Bs,p(t.detailData.vt_name),1),d(" kh\xF4ng?. ")])]),e("div",Os,[e("button",{type:"button",class:"btn btn-light","data-bs-dismiss":"modal",onClickPassive:l[8]||(l[8]=i=>t.quitUpdateData())}," H\u1EE7y b\u1ECF ",32),e("button",{type:"button",class:"btn btn-primary",onClickPassive:l[9]||(l[9]=i=>t.updateData())}," \u0110\u1ED3ng \xFD ",32)])])])],544)],64)}const aa=oe(ot,[["render",js]]);export{aa as default};
